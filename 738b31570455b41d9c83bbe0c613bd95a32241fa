Backport of https://github.com/whatwg/html/pull/780 before finished
